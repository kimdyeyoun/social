<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" th:with="user=${#authentication.principal}">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>나가자 관리자</title>
	<link rel="stylesheet" href="../assets/vendors/iconfonts/mdi/css/materialdesignicons.css">
	<link rel="stylesheet" href="../assets/css/shared/style.css">
	<link rel="stylesheet" href="../assets/css/demo_1/style.css">
	<link rel="shortcut icon" href="../asssets/images/favicon.ico"/>
	<script src="https://cdn.ckeditor.com/4.8.0/full/ckeditor.js"></script>
	<style type="text/css">
		.current {
			border: 1px solid;
			background: #696ffb;
			color: #FFFFFF;
			margin-right: 3px;
			border-radius: 4px;
			width: 3%;
		}
		.paging {
			border: 1px solid #f2f4f9;
			background: #FFFFFF;
			margin-right: 3px;
			border-radius: 4px;
			width: 3%;
		}
	</style>
</head>
<body class="header-fixed">
<th:block th:include="/../hf/header.html"></th:block>
<div class="page-body">
	<th:block th:include="/../hf/sidebar.html"></th:block>
	<div class="page-content-wrapper">
		<div class="page-content-wrapper-inner">
			<div id="content-viewport">
				<div class="row">
					<div class="col-12" style="margin-bottom: 15px; display: flex; justify-content: space-between;">
						<h4>상품 관리</h4>
					</div>
				</div>
				<div class="row">
					<div class="col-12">
						<div class="grid">
							<p class="grid-header">상품 등록</p>
							<div class="card-body">
								<br>
								<div class="grid-body">
									<div class="item-wrapper">
										<div class="table-responsive">
											<form th:action="|/product/update/${product_id}|" id="updateForm" method="POST" enctype="multipart/form-data">
												<table class="table table-bordered" style="width: 100%; cellspacing: '0'; margin: auto;">
													<tbody>
														<tr>
															<td>상품 구분</td>
															<td>
																<select class="form-control" name="product_type" style="width: 150px;">
																	<option value="0" th:selected="${product.product_type == 0}">강마루</option>
																	<option value="1" th:selected="${product.product_type == 1}">원목마루</option>
																</select>
															</td>
														</tr>
														<tr>
															<td>제품번호</td>
															<td><input type="number" class="form-control" name="product_no" th:value="${product.product_no}" style="width: 150px;"></td>
														</tr>
														<tr>
															<td>제품명</td>
															<td><input type="text" class="form-control" name="product_title" th:value="${product.product_title}"></td>
														</tr>
														<tr>
															<td>서브 제품명</td>
															<td><input type="text" class="form-control" name="product_sub_title" th:value="${product.product_sub_title}"></td>
														</tr>
														<tr>
															<td>이미지(기존)</td>
															<td>
																<th:block th:each="file : ${productFile}">
																	<img th:src="|https://pref-bucket.s3.ap-northeast-2.amazonaws.com/images/${file.product_file}|" th:id="|img_${file.product_file_id}|" th:onclick="|DeleteFile(${file.product_file_id});|" style="width: 150px;">
																	<input type="hidden" th:id="|file_${file.product_file_id}|" th:value="${file.product_file}">
																</th:block>
															</td>
														</tr>
														<tr>
															<td>이미지(추가)</td>
															<td><input type="file" multiple="multiple" name="file"></td>
														</tr>
														<tr>
															<td>구성</td>
															<td><input type="text" class="form-control" name="product_configuration" th:value="${product.product_configuration}"></td>
														</tr>
														<tr>
															<td>규격</td>
															<td><input type="text" class="form-control" name="product_standard" th:value="${product.product_standard}"></td>
														</tr>
														<tr>
															<td>종류</td>
															<td><input type="text" class="form-control" name="product_kind" th:value="${product.product_kind}"></td>
														</tr>
														<tr>
															<td>특징</td>
															<td><textarea class="form-control" id="ckeditor" name="product_character" th:text="${product.product_character}"></textarea></td>
														</tr>
														<tr>
															<td>상태</td>
															<td>
																<select class="form-control" name="product_status" style="width: 150px;">
																	<option value="0" th:selected="${product.product_status == 0}">비활성화</option>
																	<option value="1" th:selected="${product.product_status == 1}">활성화</option>
																</select>
															</td>
														</tr>
													</tbody>
												</table>
												<div class="mx-auto" style="text-align: center; margin-top: 10px;">
													<a type="button" href="/product/list" class="search_btn btn btn-secondary">취소</a>
													<button type="button" class="search_btn btn btn-primary" th:onclick="|UpdateBtn(${product.product_id});|">수정</button>
												</div>
												<input type="hidden" id="origin_file" name="origin_file">
											</form>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<th:block th:include="/../hf/footer.html"></th:block>
<script src="/assets/vendors/js/core.js"></script>
<script src="/assets/vendors/apexcharts/apexcharts.min.js"></script>
<script src="/assets/vendors/chartjs/Chart.min.js"></script>
<script src="/assets/js/charts/chartjs.addon.js"></script>
<script src="/assets/js/template.js"></script>
<script src="/assets/js/dashboard.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
	CKEDITOR.plugins.addExternal('youtube', '/youtube/plugin.js');
	CKEDITOR.plugins.addExternal('video', '/video/plugin.js');
	
	CKEDITOR.replace('ckeditor',
	{
		// extraPlugins : 'youtube',
	   uploadUrl: "/editor/drag?path=dnmaison/product",						// 드래그 드롭을 위한 URL
	   filebrowserUploadUrl: "/editor/basic?path=dnmaison/product"			// 파일업로드를 위한 URL
	});

	var origin_file =[];
	
	function DeleteFile(e)
	{
		var file_item = $("#file_" + e).val();
		
		origin_file.push(file_item);
		
		$("#img_" + e).css("display", "none");
	}
	
	function UpdateBtn(e)
	{
		if(confirm("수정하시겠습니까?") == true)
		{
			$("#origin_file").val(origin_file);
			
			$("#updateForm").su나가자t();
		}
		else
		{
			return false;
		}
	}
</script>
</body>
</html>